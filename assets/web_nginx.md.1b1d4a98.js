import{_ as n,c as s,o as a,d as l}from"./app.18b2d180.js";const p="/nginx-ld.png",e="/nginx-download.png",u=JSON.parse('{"title":"nginx 升级至稳定版本","description":"","frontmatter":{},"headers":[{"level":2,"title":"漏洞描述","slug":"漏洞描述","link":"#漏洞描述","children":[]},{"level":2,"title":"解决思路 && 执行步骤","slug":"解决思路-执行步骤","link":"#解决思路-执行步骤","children":[]},{"level":2,"title":"至此，nginx版本从原有的1.5 升级到现在的 1.22.1","slug":"至此-nginx版本从原有的1-5-升级到现在的-1-22-1","link":"#至此-nginx版本从原有的1-5-升级到现在的-1-22-1","children":[]}],"relativePath":"web/nginx.md"}'),i={name:"web/nginx.md"},t=l('<h1 id="nginx-升级至稳定版本" tabindex="-1">nginx 升级至稳定版本 <a class="header-anchor" href="#nginx-升级至稳定版本" aria-hidden="true">#</a></h1><blockquote><p>背景：之前参与的项目，客户侧扫描到关于nginx的漏洞，解决方法就是把当前版本升级到稳定版本。</p></blockquote><h2 id="漏洞描述" tabindex="-1">漏洞描述 <a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a></h2><img src="'+p+'"><blockquote><p>[这个地址其实是没什么用的,打开 404 ，还不如CSDN靠谱]&lt;<a href="https://www.nginx.com/blog/updating-nginx-dns-resolver-vulnerability-cve-2" target="_blank" rel="noreferrer">https://www.nginx.com/blog/updating-nginx-dns-resolver-vulnerability-cve-2</a> 021-23017/&gt;</p></blockquote><h2 id="解决思路-执行步骤" tabindex="-1">解决思路 &amp;&amp; 执行步骤 <a class="header-anchor" href="#解决思路-执行步骤" aria-hidden="true">#</a></h2><ol><li><p>下载nginx 最新版本</p><ul><li><img src="'+e+`"></li><li>[官网地址]<a href="http://nginx.org/en/download.html" target="_blank" rel="noreferrer">http://nginx.org/en/download.html</a></li></ul></li><li><p>进入服务器，停掉当前的nginx服务</p><ul><li>查询nginx进程号</li><li>kill掉nginx进程</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;"> ps -ef | grep nginx</span></span>
<span class="line"><span style="color:#A6ACCD;"> kill -9 1131</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>解压至/usr/local</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">   tar -xvf nginx-1.14.0.tar.gz -C /usr/local</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>make安装</p><ul><li>cofigure创建一个makeFile文件</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">./configure \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--prefix=/usr/local/nginx \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--pid-path=/var/run/nginx/nginx.pid \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--lock-path=/var/lock/nginx.lock \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--error-log-path=/var/log/nginx/error.log \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-log-path=/var/log/nginx/access.log \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--with-http_gzip_static_module \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-client-body-temp-path=/var/temp/nginx/client \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-proxy-temp-path=/var/temp/nginx/proxy \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--http-scgi-temp-path=/var/temp/nginx/scgi \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--with-http_stub_status_module \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--with-http_ssl_module \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--with-file-aio \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--with-http_realip_module </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>[\\ 表示命令还没有输入完，换行的意思。 --prefix=/usr/local/nginx 表示软件安装到/usr/local/nginx下面。 这个make install 的时候就不用在指定安装路径。 执行完成后查看目录里面已经多了一个Makefile文件 ]</p><ul><li>make &amp; make install</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">296  make</span></span>
<span class="line"><span style="color:#A6ACCD;">297  make install</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>启动nginx</p><p>这个时候需要到外层，找到一个nginx的文件夹，在这个文件夹里执行后续的操作</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">315  cd /nginx/sbin/</span></span>
<span class="line"><span style="color:#A6ACCD;">317  ./nginx</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>查看nginx版本以及config是否配置正确</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">[root@localhost sbin]# ./nginx -v</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx version: nginx/1.22.1</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">[root@localhost sbin]# ./nginx -t</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>windows版本的升级，直接下载对应版本的包替换即可</p></li></ol><h2 id="至此-nginx版本从原有的1-5-升级到现在的-1-22-1" tabindex="-1">至此，nginx版本从原有的1.5 升级到现在的 1.22.1 <a class="header-anchor" href="#至此-nginx版本从原有的1-5-升级到现在的-1-22-1" aria-hidden="true">#</a></h2>`,8),o=[t];function c(r,g,C,d,h,A){return a(),s("div",null,o)}const y=n(i,[["render",c]]);export{u as __pageData,y as default};
